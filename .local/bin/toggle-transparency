#!/bin/bash

transparency_process="$(pgrep -f inactive-transparency)"
if [ -n "$transparency_process" ]; then
    kill -9 $transparency_process
    swaymsg -t get_tree | jq -r '.. |
    select(.type? == "con" and .id? and (.app_id != null or
    (.window_properties? // {} | .class != null))) |
    .id' | while read -r id; do
	swaymsg "[con_id=$id]" opacity 1
    done
else
    inactive-transparency >/dev/null 2>&1 &
fi
